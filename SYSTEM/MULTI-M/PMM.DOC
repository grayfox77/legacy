
----------------------------------------------------------------------------

           圧縮ファイルメンテナンスツール 【ＰＭＭ】 for MSX-DOS2

                                version 2.00

                        Copyright(C)1993-1995 いーた

----------------------------------------------------------------------------


                               User's manual



1. PMM とは


    　PMM は、アーカイブファイル（書庫）を、解凍作業を行なうことなく任意のフ
    ァイルの内容の閲覧、編集、削除、解凍を行なうアーカイバ支援ツールです。



2. PMM の機能


    　PMM の持つ主な機能は以下の通りです。

	o 閲覧（要ビュアー）
	o 編集（要テキストエディタ・圧縮ツール）
	o 削除
	o 解凍
	o CRC チェック
	o 自己解凍書庫の作成（要自己解凍モジュール）



3. PMM を使う前に


3.1 必須ツール

    　PMM を使用するには、最低限、書庫を解凍するためのツールが必要です。著名
    なものを以下に挙げます。

	    PMext (ぺぱあみんと★すたあ氏作)
	    LHrd  (H.Saito氏作)
	    LHEXT (きょうぢゅ氏作)

    　これ以外にも、圧縮ツール、テキストエディタ、ビュアー（ファイル閲覧ツー
    ル）などを必要に応じて用意してください。

    　また、カスタマイズを行なうために CS (version 3 以降) が必要です。 これ
    は  PMM のなかには含まれていませんので、別途ダウンロードしておいてくださ
    い。


3.2 対応する書庫形式

    　PMM は、次の圧縮形式を持つ書庫をメンバとして認識することができます。

	PMarc(2)による圧縮      -pm0- -pm1- -pm2-
	Larcによる圧縮          -lzs- -lz4- -lz5-
	LHarc,LHAによる圧縮     -lh0- -lh1- -lh4- -lh5- -lh6- -lh7-

    　PMA 形式および LZH(LZS) 形式の書庫には、各メンバごとに圧縮形式とは別に
    "ヘッダ" と呼ばれる管理領域があり、 これはレベル０〜２までの３種類があり
    ます。PMM ではこのうちレベル０、１には完全に対応、またレベル２ヘッダにも
    タイムスタンプが正常に表示されないことを除いて対応しています。
    　なお、圧縮形式およびヘッダは、PMM が対応していても、使用している解凍ツ
    ールが対応していなければ各機能が実行できない場合があります。解凍ツールの
    ドキュメントもあわせて確認してください。


3.3 環境

3.3.1 動作環境

    　PMM を使用するためには次の動作環境が必要です。

	機種    MSX2 (要VRAM128KB以上)
	OS      MSX-DOS2

    　また、マウスモードで使用するときはマウスが必要です。

    　PMM は、外部漢字フォントとして MSXView 専用漢字ROM（またはＡ１ＧＴの内
    蔵フォントROM）があればそれを使うようになっています （使わないように設定
    することもできます）。


3.3.2 メモリ

    　PMM は外部コマンド実行時に、空きマッパRAM を１枚(16KB)使用します（使用
    しないように設定することもできます）。
    　空きマッパRAM は必ずしも確保する必要はありませんが、確保しておけばディ
    スクアクセスが減って快適になります。
    　マッパRAM の確保には、RAMDISK 容量を減らすなどの方法があります。


3.3.3 環境変数

    　PMM は次の環境変数を参照します。

	PMM     　PMM の起動オプションの既定値を設定します。よく使うオプショ
		ンはここに書いておけばいちいちコマンドラインから指定する必要
		がなくなるので便利でしょう。同一のオプションを環境変数とコマ
		ンドラインから与えた場合は、コマンドラインのオプションが優先
		されます。

	TEMP    　作業ファイルを作成するドライブとディレクトリです。TEMP  が
		設定されていない場合は  TMP も参照し、それもなかったときはカ
		レントのドライブとディレクトリになります。RAMDISK のような高
		速なドライブに設定しておいてください。

	DATE    　画面右上の日付の表示形式です。デフォルトは YY-MM-DD

	TIME    　画面右上の時間の表示形式です。12 または 24  のどちらかを指
		定します。たとえば12時34分の場合、12を指定すると "00:34p" と
		なり、24を指定すると "12:34" と表示されます。デフォルトは 24

	PATH    　解凍ツールなど、実行ファイルの入っているディレクトリを設定
		しておきます。; (セミコロン) で区切って複数の指定もできます。



4. カスタマイズ


    　PMM を快適に使用するためには、ユーザーの環境に合った初期設定、いわゆる
    カスタマイズを行なっておく必要があります。カスタマイズするためには CS と
    いうソフトが必要です。これは PMM には含まれていませんので、 別途ご用意く
    ださい。
    　カスタマイズを行なうには、PMM.CFG というファイルをテキストエディタで書
    き換えます。その後、コマンドラインより

	    CS PMM

    と入力するだけで終了です。


4.1 記述方法

    　CFG ファイル内で使える項目について説明します。デフォルトで最適な設定を
    してありますので、ほとんどの項目はそのままで大丈夫でしょう。


4.1.1 記述にあたってのルール

    　CFG ファイルには何でも自由に書けるわけではなく、記述する上でのルールが
    ありますので、それらをしっかり踏まえたうえで設定を行なってください。

	・; (セミコロン) 以降はコメントと見なします。空行は無視されます。
	・文字列は " (ダブルクォーテーション) で囲む必要はありませんが、たと
	  えば文字列の前後に半角スペースを入れたいときなどは "  で囲まなけれ
	  ばなりません。
	・文字列中にコントロールコードを入れたい場合は「^A」のように ^ (ハッ
	  トマーク) と英文字１字との組み合わせであらわします。^ そのものを記
	  述したいときは ^^ としてください。ところで ^M^J は  CR+LF、 つまり
	  MS-DOS  テキストの改行コードとなりますが、これを利用して通常１つし
	  か記述できないコマンドを ^M^J で区切って２つ以上実行させることがで
	  きます。ただし、全体の長さがその項目で決められている文字列長を超え
	  てはなりません。この記述法は実際に CFGファイル内で使用されています
	  ので参考にしてください。
	・数値をとる項目では、1 の代わりに True、0 の代わりに False と書くこ
	  ともできます。
	・最後にある意味不明のデータは、カスタマイズ情報を文字化したもので、
	  CS が参照します。よって絶対に書き換えたりしないでください。 不用意
	  に書き換えてカスタマイズすると、PMM.COM が壊れます。


4.1.2 マクロ文字

    　PMM.CFG 内にはコマンドを記述する箇所が多くありますが、これらには解凍す
    るファイル名などの、その場ごとに変化する文字列を渡してやらなければなりま
    せん。そのために、PMM はコマンドに対して "マクロ文字" という特殊な文字列
    を使用してそういった流動的なデータを与えることができるようになっています。
    　マクロ文字は $ (ドル記号) と英字１文字の組み合わせであらわされます。こ
    れらは大文字と小文字の区別があるので注意してください（現在はすべてのマク
    ロが大文字ですが、将来、 小文字のマクロを追加する可能性があります）。 $$
    と書くことで、$ ひとつをあらわします。
    　たとえば、後述する拡張子対応情報などでは、ほとんどのコマンドが引数とし
    て解凍するファイル名を渡してやらなければなりません。そういったとき、コマ
    ンド名の後ろに $B と書いてやれば、実際にそのコマンドが実行されるときは、
    $B の部分が選択された解凍ファイル名に置き換わります。

	    $H      書庫ドライブをあらわします。例) A:

	    $P      書庫ディレクトリをあらわします。これはドライブ名が取り除
		    かれたルートディレクトリからの絶対パスです。最後は \  で
		    終わります。例) \FOO\BAR\

	    $G      書庫ファイル名から拡張子を取り除いたものです。
		    例) ARCNAME

	    $A      書庫ファイル名にドライブ名が付加されたものです。
		    例) A:ARCNAME.LZH

	    $E      書庫ファイル名のフルパスです。PMM 起動時にどのような指定
		    をしても、このマクロは必ずフルパスに展開されます。
		    例) A:\FOO\BAR\ARCNAME.LZH

	    $B      解凍ファイル名にドライブ名が付加されたものです。
		    例) B:EXTNAME.TXT

	    $C      解凍ファイル名です。例) EXTNAME.TXT

	    $S      解凍ファイル名から拡張子を取り除いたものです。
		    例) EXTNAME

	    $F      解凍先のドライブです。例) B:

	    $I      解凍先ドライブ／ディレクトリです。
		    例) B:\EXT\RACT\

	    $D      一時ドライブです。これは環境変数 TEMP が指すドライブと同
		    一になります。

	    $O      起動時のカレントドライブです。

	    $N      起動時のカレントドライブ／ディレクトリです。

	    $K      コマンドを実行後、キー入力待ちをします。このマクロはどこ
		    に書いてもかまいません。

	    $R      追加パラメータを入力するウィンドウを開きます。


4.1.3 カスタマイズ項目の解説

    editor          　使用するテキストエディタです。

    pager           　使用するファイル表示ツールです。
		    　手頃なツールがない場合は TYPE コマンドでも代用できます。
		    その際、漢字表示させたい場合は PMM  を漢字モードで起動し
		    てください。

    pma_extract
    pma_pack
    pma_delete      　それぞれ -pm?-  形式の書庫に対する解凍・圧縮・削除ツー
		    ルの指定です。 デフォルトでは PMEXT および PMARC2 を使う
		    ようになっています。

    lzh_extract
    lzh_pack
    lzh_delete      　同様に、-lh?- 形式の書庫に対する解凍・圧縮・削除ツール
		    の指定です。これもデフォルトでは PMEXT および PMARC2  を
		    使うようになっています。

    lh5_extract
    lh5_pack        　-lh5- -lh6- -lh7- 形式の書庫に対する解凍・圧縮ツールを
		    指定したいときに使います。lzh_extract などとはツールを変
		    えたいときに使います。ここに何も指定しない場合はそれぞれ
		    pma_extract・pma_pack のツールを使います。

    pma_crccheck
    lzh_crccheck    　CRC チェックのためのツールを指定します。

    make_sfx        　SFX (自己解凍書庫) の作成のためのツールを指定します。

    ankfontfile     　半角フォントファイル名をフルパスで指定します。指定され
		    た場合はそのファイルが PMM 起動時に読み込まれ、 以後この
		    フォントを使用します。 指定がない場合は ROM のフォントが
		    使用されます。
		    　半角フォントファイルは１文字８バイトでコード 0〜255 の
		    すべての文字をベタセーブした 2048 バイトのファイルです。
		    また特別に、コード 32〜255 までの 1792  バイトのファイル
		    （ＭＭなどで使用されるもの）にも対応しています。これはフ
		    ァイルサイズにより自動判別されます。

    red
    green
    blue            　背景色のパレットを、赤緑青の３色それぞれ指定します。そ
		    れぞれの値は 0〜7 の範囲をとります。

    markchr         　マークに使用するキャラクタを指定します。指定できるのは
		    半角キャラクタの１文字のみです。省略されたときは、PMM 自
		    身が持つ矢印記号を使用します。

    hisfile
    phsfile         　ヒストリーの内容を保存するためのファイル名を指定します。
		    hisfile はコマンドヒストリー、phsfile はパスヒストリーで
		    す。指定するファイル名にディレクトリパスは付けられません。
		    このファイルは PMM.COM  を読み込んだディレクトリと同じデ
		    ィレクトリに自動的に作成されます。

    treefile        　ディレクトリツリー選択モードで、[W] キーによって作成さ
		    れる、ディレクトリ情報が保存されるファイル名を指定します。
		    ディレクトリパスは付けられません。このファイルは任意のド
		    ライブのルートディレクトリに作成されます。
		    　なお、このファイルはＭＭと互換性があります。内部仕様に
		    ついてはＭＭのマニュアル内で公開されています。

    short_msg       　複数ファイルをマークして解凍するとき、解凍ツールの出す
		    メッセージの代わりに PMM  側で用意した簡略メッセージを使
		    用するかを指定します。0 で使用しない、1 で使用するです。
		    　ただし、この指定をすると解凍ツールの出すのエラーが画面
		    に表示されなくなるので注意してください。また、この機能は
		    解凍ツールの表示を NUL  デバイスへリダイレクトすることで
		    実現しているため、たとえばエラーを標準エラー出力に対して
		    出力するような解凍ツールを使うと、画面が乱れることがあり
		    ます。

    lower           　1 にすると、画面上のファイル名表示が小文字になります。

    interlace_mode  　1 にするとインターレースモードになります。起動時のモー
		    ドには影響されません。

    key_click       　1 にするとキークリック音をONにします。BASIC の  SCREEN
		    ,,1 と同じです。

    tree_fdisp      　ディレクトリツリー選択モードで、カーソル移動ごとにその
		    ディレクトリのファイルを表示するかを指定します。0 で表示
		    しない、1 で表示するです。これはツリーモードでも [F]  キ
		    ーで切り替えが可能です。

    nouse_mapper    　PMM は、外部コマンド実行時に PMM の内部情報をマッパRAM
		    に退避します。これにより、子プロセスからの復帰が高速にな
		    ります。しかし、子プロセス環境でもメモリを多く確保したい
		    ときなどは、これを 1 にすることで、マッパRAM  を確保しな
		    くなります。

    nouse_viewfont  　PMM は、漢字表示の際、MSXView 付属のフォントROM （また
		    はＡ１ＧＴの内蔵フォントROM） があれば自動的にそのフォン
		    トを使用するようになっています。これを 1 にすると、 フォ
		    ントROM を使用せず、つねに通常のMSX漢字ROMを使用するよう
		    になります。フォントROM が原因で不都合が起こる場合に指定
		    してみてください。

    use_mouse       　1 にするとマウスモードとなり、通常のキーボードでの入力
		    のほかに、マウスによる入力も可能になります。ポート２に接
		    続されたマウスを使用するときは 1 ではなく 2 を指定してく
		    ださい。

    language        　PMM のメッセージは通常すべて日本語ですが、これを 1  に
		    するとすべて英語になります。ただし、日本語のファイル名や
		    メンバはこの指定に関係なくつねに日本語で表示されます。

    30              　1 にすると、通常は25行の画面表示を30行に拡張します。フ
		    ォントは１ライン抜いて表示するため、若干見にくくなるかも
		    しれません。ankfontfile で外部フォントを指定するといいで
		    しょう。英語モードで使われることをおすすめします。


4.2 拡張子対応情報

    　PMM は、拡張子ごとに別々のコマンドを実行させる「拡張子判別実行機能」を
    持っています。そのために、あらかじめ拡張子ごとに、それが選択されたときに
    実行させるコマンドを設定しておく必要があります。この情報も PMM.CFG  に記
    述しますが、書式に若干の違いがあります。

    　まず、次の例を見てください。

	    .MAG    = MAG $B

    　先頭が . (ピリオド) ではじまる項目は拡張子対応情報と見なされます。拡張
    子はその直後に続けて１〜３文字で指定し、= をはさんで実行されるコマンドを
    記述します。マクロ文字も使用できます。これをそれぞれの拡張子について任意
    の数だけ記述してください。
    　PMM は、対象ファイルの持つ拡張子がここで記述したものに合致するか１つず
    つ検査していき、合致したらそのコマンドを実行させます。もしどれにも合致し
    なかった場合は pager  の項目で設定されているファイル表示ツールによってそ
    の内容が表示されます。ですから、通常のテキストファイルなどはここに記述す
    る必要はありません。

    　拡張子には次のようにワイルドカードを指定することもできます。

	    .SC?    = BLS $B

    　ワイルドカード ? は任意の１文字をあらわし、 合致すればそのコマンドを実
    行します。ただし、拡張子は上から順に合致するかどうか検査していくので、こ
    れより前に合致する拡張子があった場合はそれが実行されてしまいます。
    　また、 ワイルドカード  *  はそれ以降の任意の文字をあらわします。  要は
    MSX-DOSのワイルドカードと一緒です。



5. 起動


    　PMM は、コマンドラインより次のような形式で入力して起動させます。ファイ
    ル名を指定せず、ただ PMM と入力することで、 オプション一覧などの簡単な説
    明を表示します。

	PMM <filename> [/options]

    <filename>  　書庫ファイル名を１つ指定してください。 拡張子  PMA  および
		LZH は省略できます。その他の拡張子を持つ書庫ファイルは拡張子
		まで含めて指定してください。

    [/options]  　PMM v2.00 より、従来はカスタマイズでしか設定できなかった項
		目の一部をコマンドラインからも設定できるようにしました。この
		オプションは環境変数 PMM に記述しておくこともできます。 オプ
		ションキャラクタには / 以外に - も使えます。複数のオプション
		は /IM のようにまとめて記述することができますが、/2 のような
		数字オプションは必ずオプションキャラクタに続けて指定しなけれ
		ばなりません。n には任意の数値を指定し、省略されると 1  を指
		定したことになります。

	/In     インターレースモード。0 で OFF、1 で ON

	/Mn     マウスモード。0 で使用しない、1 でポート１のマウスを使用、 2
		でポート２のマウスを使用します。

	/2      画面を25行モードにします。

	/3      画面を30行モードにします。

	/Ln     言語を選択します。0 で日本語、1 で英語になります。

	/Vn     MSXView 付属のフォントROM を使用するかを指定します。0 で使用
		する、1 で使用しません。

	/Rn     外部コマンド実行時のマッパRAM 使用を指定します。0 で使用する、
		1 で使用しません。



6. 操作方法


    　以下はキーボードでの操作方法を解説しています。一部のキーはファンクショ
    ンキーにも割り当てられており、テンキーのある機種ではその入力も有効です。
    　解説中に「メンバ」という言葉が出てきますが、これは書庫ファイルに格納さ
    れている各ファイルのことを指します。


6.1 メイン画面

	[↑][↓]
	[←][→]        カーソルを移動します。

	[F1],[?]        簡単な操作方法を表示します。

	[F2],[V]        メンバを閲覧します。

	[F3],[E]        メンバをテキストエディタで編集します。編集されたファ
			イルは圧縮ツールで書庫ファイルに戻されます。

	[F4],[D]        メンバを削除します。すべてのメンバを削除すると、書庫
			ファイル自体が削除されます。

	[F5],[U]        メンバを解凍します。

	[S]             自己解凍ファイルを作成します。

	[C]             CRC  チェックをします。 結果は  pma_crccheck  および
			lzh_crccheck  で設定したツールによって表示された画面
			で確認してください。

	[RETURN]        メンバを解凍し、そのメンバの持つ拡張子に対応するコマ
			ンドを起動します。例えば画像ファイルを画像表示ツール
			で鑑賞したり、MGS データをすぐに演奏ツールに渡して演
			奏させたりすることができます。
			拡張子によってどのコマンドを起動させるかの情報は
			PMM.CFG 内に記述します。詳しくは「拡張子対応情報」の
			説明を見てください。

	[BS]            カーソルを先頭／最後に移動します。

	[SPACE]         カーソル位置にあるメンバをマーク（選択）します。マー
			クしたメンバには矢印（または markchr で設定した文字）
			が付き、閲覧・編集・削除・解凍・CRC チェックの各機能
			において、マークされているメンバ全てが対象となります。

	[TAB]           カーソル位置にあるメンバをマークします。[SPACE] との
			違いは、マークした後もカーソル位置が変わらないことで
			す。これに対し、[SPACE] でマークするとカーソル位置は
			１つ下に移動します。

	[HOME]          １つ以上マークされているときはすべてのマークを解除し、
			１つもマークされていないときはすべてのメンバをマーク
			します。

	[CTRL]+[HOME]   すべてのマークを反転します。

	[ESC]           PMM を終了します。

	[Q]             PMM を強制終了します。[ESC] と違い、確認メッセージを
			出しません。


6.2 ヒストリー選択モード

    　コマンドやディレクトリの入力画面で [↑] キーを押すと、ヒストリー選択モ
    ードになります。ここには過去に入力されたコマンドやディレクトリが保存され
    ていて、前と同じような入力をするときなどは、ここから簡単に以前の内容を呼
    び出すことができます。
    　ヒストリーの内容は、 種類に応じて２つのファイルに保存されます。 これは
    PMM.CFG の hisfile および phsfile の項目で設定できます。

	[↑][↓]        カーソルを移動します。

	[←]            １ページ前に移動します。

	[→]            １ページ次に移動します。

	[RETURN]        カーソル位置の内容を決定します。

	[ESC]           ヒストリーを終了します。


6.3 ディレクトリツリー選択モード

    　解凍時に [RETURN] キーのみを入力すると、ディレクトリツリー選択モードに
    なり、目的のディレクトリをカーソル操作で選択することができます。画面や操
    作方法などはＭＭの同じ機能とできるだけ合わせてあります。

	[↑][↓]        カーソルを移動します。

	[←][→]        ページ移動を行ないます。

	[L]             ドライブを変更します。続けて [A]〜[H] キーでそれぞれ
			のドライブに切り替わります。また、[RETURN]  キーのみ
			の入力で現在のドライブを再度読み込みます。

	[0]〜[7]        ドライブを変更します。数字キーはそれぞれドライブ  A:
			〜H: に対応しています。

	[F]             ファイル一覧のON/OFFを切り替えます。  ファイル一覧が
			ON  になっているときは、カーソルを移動させるごとに、
			画面右の「ファイルの一覧」にそのディレクトリ内のファ
			イルが最大20個まで表示されます。この一覧は、 [SHIFT]
			キーを押しながらカーソルを移動させることで一時的に表
			示させないこともできます。デフォルトの状態は PMM.CFG
			の tree_fdisp の項目で設定できます。

	[W]             ディレクトリ情報をファイルに書き出します。ファイル名
			は PMM.CFG の treefile の項目で設定できます。 このフ
			ァイルを作ったドライブは、次のツリーモードからはこの
			ファイルを読むだけですむので起動が高速になります。な
			お、ディレクトリを作成または削除すると、このファイル
			と実際のディレクトリ構成に食い違いが出てしまうので、
			そのつど [R] キーでディレクトリを再検索し、続けて [W]
			キーを押してファイルを更新しておいてください。
			なお、このファイルはＭＭと互換性があります。内部仕様
			についてはＭＭのマニュアル内で公開されています。

	[R]             ディレクトリ情報を再検索します。

	[SHIFT]+[英字]  先頭が[英字]のディレクトリ名を検索し、その位置にカー
			ソルを移動します。

	[ESC]           ツリーモードを終了します。



7. 使用規定


    　PMM はフリーソフトウェアです。作者の いーた が著作権を保有します。
    　PMM の転載は自由で、作者への連絡も不要です。そのかわり、転載された方は
    できるかぎりバージョンアップなどのサポートをしていただくようお願いします。
    感想なども作者まで転送していただけるとありがたいです。
    　転載にあたっては、説明書の冒頭にある内容一覧のファイルがすべてそろった
    状態であれば、どんな形式でもかまいません。書庫形式を変更するのも自由です。
    ただし、作者に無断でパソコン通信以外のメディアに転載することを禁じます。
    　PMM は原則として無償で配布してください。その際、配布の際にかかった実費
    まで回収することを認めます。

    　PMM を使用した結果の事故および損害については、作者は一切の責任を負いま
    せん。また、バージョンアップ及びサポートの義務も負わないこととしますが、
    作者としては可能な限りサポートしていく所存ですので、どうかよろしくご支援
    ください。



8. 作者より


　むぅ…
　PMM もついに 2.00 となりました。どこが変わったのかと聞かれると非常に困りま
す(^_^;
　そんなわけで、ばい〜
                                                                  いーた

                                                ナツメネット    NAT26069
                                                東京BBS         ITA     


・MS-DOS版LHA,LHarc は 吉崎栄泰氏のフリーソフトウェアです。
・LHMTN は 石田健仁氏のフリーソフトウェアです。
・PMシリーズおよびPopCom! は ぺぱあみんと★すたあ氏のフリーソフトウェアです。
・LHEXT は きょうぢゅ氏のフリーソフトウェアです。
・KID は MSX-DOS2 TOOLS に含まれるもので、株式会社アスキーの市販品です。
・VF は HyDE氏のフリーソフトウェアです。
・LHa,LHrd は H.Saito氏のフリーソフトウェアです。
・Larc は 三木和彦氏によるフリーソフトウェアです。
・TT は TAC氏のフリーソフトウェアです。

    　すぺしゃる感謝: たかを,なむ,マッティー,まる中,MOGU (敬称略)
    　このドキュメントの整形にはＸＴＲ（村上真雄氏作／MS-DOS用）を使わせてい
    ただきました。


                                                        << end of PMM.DOC >>
