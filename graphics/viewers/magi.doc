▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼▽▼

  [MAG/MAKI/Pi] image viewer					MAGI.COM

	ＭＡＧｉ ver0.22

		動作機種：MSX2+/turboR
				VDP : V9958

		動作環境：MSX-DOS2
				MMS(Memory-Mapper) : 1seg or over

	copyright (c)1996	Hiroyuki_KAKAMI		各務 裕之

▲△▲△▲△▲△▲△▲△▲△▲△▲△▲△▲△▲△▲△▲△▲△▲△▲△▲△▲△▲



■【概要】

　MSX-DOS2 の外部コマンドとして動作する、画像ローダです。
　表示方法には、以下が選択できます。

	・ＹＪＫモード (256x424:19268)，単純閾値法
	・ＲＧＢモード (256x424:  256)，単純閾値法
	・１６Ｃモード (512x424:   16)			※16色画像のみ


　以下の画像フォーマット（拡張子）に対応しています。

	・MAG-format (16/256色)					.MAG
	・MAKI-format (16色)					.MKI
	・Pi-format (16色)	[※256色画像は未対応]		.PI


　対応できる横ピクセルサイズの最大値は、以下の通りです。
	・16色画像	: 2048
	・256色画像	: 1024


　以下の説明のうち、次のような文字はそれぞれ次の意味を表します。
	< ･･ >	：　省略不可能
	[ ･･ ]	：　省略可能



■【使用方法】

　MAGi は MSX-DOS2 上で使用します。usage は次のようになります。

	:> MAGI.COM  <ファイル[.MAG]>  [オプション]


《ファイル》
　画像ファイルを、Drive-Path-File で指定します。

　ワイルドカードの指定も可能です。その場合、キー入力によって設定を変えた
場合も、次のファイルでは強制的にオプションによる設定に戻されます。
　ただし、表示方法（ＹＪＫ／ＲＧＢ／１６Ｃ）だけは継続されます。

　拡張子無指定の場合は、".???" が選択されます。


《オプション》
　オプションは大文字でも小文字でも構いません。
　１つのオプションの前には、必ず１つの "/" を付けてください。


  /H	  : help
		ヘルプを標準出力に表示します。

  /I	  : info
		表示方法をファイル情報表示に変更します。

  /S<n>   : screen
		表示方法を選択します。
			・1 : ＹＪＫ
			・2 : ＲＧＢ
			・3 : １６Ｃ (default)
			・5 : ファイル情報
		１６Ｃモードは、256色画像では自動的にＲＧＢに変更されます。

  /Z{0|1} : eternal-loop
		無限ループスイッチを変更します。
			・省略 : toggle
			・0    : off (default)
			・1    : on

  /D<str>   : bsave-dir
		BSAVE 機能によって保存されるディレクトリを指定します。
		省略時はカレントディレクトリになります。
		ルートでない限り、末尾の "\" は省略出来ます。
		ドライブ指定の ":" は省略出来ません。

  /A	  : auto						(default)
		画像の横サイズに合わせて、自動的に表示型式を変更します。
			・256		: [N]		: neutral
			・512		: [M]		: middle
			・others	: [W]		: wide

  /N	  : neutral
		画像の横サイズ = 256 と見なします。

  /M	  : middle
		画像の横サイズ = 512 と見なします。

  /W	  : wide
		横に 4/5 に縮小して表示します。
		画像の横サイズ = 640 と見なします。


《キー操作》	（画像表示中）
　画像表示中はキー反応が若干鈍い為、比較的長く押し続けて下さい。

  [SPC]			次のファイルへ移ります。

  [HOME]		前のファイルへ戻ります。

  [ESC]			実行を終了して、DOS へ戻ります。

  [RET]			表示を中断します。


《キー操作》	（画像表示終了後）

  [SPC]			次のファイルへ移ります。

  [HOME]		前のファイルへ戻ります。

  [ESC]			動作を終了して、DOS へ戻ります。

  [↑] [↓]		任意スクロールします。
			画像のサイズに応じた空きＭＭＳが必要です。
			容量が足りない場合、途中までしか正常に表示されません。

  [shift] + [↑] [↓]	１画面（424ライン）分、スクロールします。
			[RET] で途中停止出来ます。

  [@]			設定を変更せずに再表示します。

  [S]+[1] [F1]		表示方法をＹＪＫモードに変更します。
  [S]+[2] [F2]		表示方法をＲＧＢモードに変更します。
  [S]+[3] [F3]		表示方法を１６Ｃモードに変更します。
  [S]+[4] [F4]		（欠番）
  [S]+[5] [F5]		表示方法をファイル情報表示に変更します。

  [A] [N] [M] [W]	表示型式を変更します。

  [C] [X]		縦に圧縮・伸長します。
			表示型式の変更で解除されます。

  [L] [R]		表示位置を、最左・最右に変更します。
			原画像が画面から横にはみ出た場合のみ有効です。

  [I]			表示方法を、画像表示←→ファイル情報表示と切替えます。

  [Z]			無限ループスイッチを、0←→1 と切替えます。

  [ctrl]+[G]		表示中の画面を BSAVE 型式でセーブします。
			オプション "/D<s>" で指定したディレクトリに書込みます。
			エラーの際は２回 beep が鳴ります。
			表示方法に対する拡張子は以下の通りです。
				・ＹＪＫモード	: ".SCC" & ".S1C"
				・ＲＧＢモード	: ".SC8" & ".S18"
				・１６Ｃモード	: ".SC7" & ".S17"
			１６Ｃモードのみ、パレットエリアまでセーブされます。


《環境変数》

　MAGIOPT	ディフォルトオプションを記述することが出来ます。



■【エラー】

・Not MSX-DOS2.
　　DOS1や他のCP/M等で起動したときに表示されます。

・Bad option.
　　存在しないオプションを指定したときに表示されます。

・Too many Parameters.
　　パラメータの数が多すぎます。

・Bad Environment-option.
　　環境変数 "MAGIOPT" に書かれた内容が不正です。

・Not enough TPA.
　　ＴＰＡサイズが不足しています。

・Not enough Memory-mapper segments.
　　メモリマッパー（プライマリ）のフリーセグメント数が不足しています。




■【諸注意】

　ＶＤＰの I/O ポートアドレスを n=n'=98h と固定している為、これ以外のＭ
ＳＸでは動作しません。（動作機種が MSX2+ 以上なので、問題無いと思います）

　ＭＭＳは最低でも１セグメント以上必要です。外部ＭＭＳにも対応しています。
不足する場合は実行出来ません。
　任意スクロールの際は、領域に応じたセグメントが必要です。不足する場合は
画面表示が正常に行われません。

　表示中に効くキーは、[SPC] [HOME] [ESC] [RET] に限定されます。
　[RET] さえ押せば全てのキーが有効になります。

　MAG の部分セーブ画像を表示する場合、以下のような相違・問題があります。
	・表示直前に画面消去を行わない
	・表示位置が横に数ドットずれる場合がある（特にＹＪＫモードで顕著）
	・直前の画像が１画面を越える場合、正しく表示されない
	・表示型式の変更（[N][M][W]）をした際、正しく表示されない



■【参考】

・ソフトバンク
		まぐろのすべて					（￥２９００）
							  まぐろＢＢＳ 編・著

・ＭＡＫＩフォーマット仕様書
		"MKBIBLE.DOC"
								   Woody_RINN

・Ｐｉ解説版 (2nd edition) '91-03-24
		"PITECH.TXT"
								      柳沢 明

・ソフトバンク
		Ｏｈ！Ｘ 1995-10 特集「Now Printing」
			減色処理と印刷いろいろ			      瀧 康史

								（敬称略）



■【使用および配布について】

　このソフトウェアは Free-ware です。著作権は作者が保持しています。営利
・非営利を問わず、誰でも無料で使用することができます。

　転載・配布は自由です。確認及び連絡なども、特に必要としません。
　各自に於いて改良・改造したものは、その旨（原作者名，改造者名，改造箇所）
を明記した上で、配布は自由とします。

　このソフトウェアを使用した結果の影響については一切の責任を負いかねます
ので、あらかじめご了承ください。


　各画像フォーマットの提唱者は下記の通りです。（敬称略）

	・MAG  format : (c)1991	   Woody-RINN
	・MAKI format : (c)1990	   Woody-RINN
	・Pi   format : (c)1990-91 柳沢明



■【奥付】

　何を今更 MAG/MAKI/Pi ローダ。
　「MAGi」を名乗るには幾分機能不足の感もありますが、ご容赦下さい。読み方
は「マギ」でも「メイジャイ」でもお好きな様に…。

　文字表示ルーチンは、１年程昔に作った Text-Viewer（未完成）から流用した
ので、意外と楽に出来ました。元は GRP5 用だったけど。
　ただ、ライン毎にしか着色出来ないのが難点。エスケープシーケンスも無視。


　Pi の８プレーン（256色）画像は展開するだけで 64KB もメモリを喰うので、
多分対応しません。やっぱ Pi は "TMP" とか "MASAPI" で見るのが正義でそ。


　ようやく BSAVE 機能が付きました。こちらは GRP6(sc7) でパレットが付加さ
れますので、ご安心を。（JPD では敢えて付けなかった）

　それにしても、ローダ毎のオプション環境変数に「/D<str>」と記入しないと、
セーブするディレクトリを指定できないのは面倒に思えてきた。
　新しい環境変数「GRPSAVEDIR」を導入して、JPD と共有するのがいいかも知れ
ない（環境変数「TMP」を使い回してもいいけど）。良い環境変数名があったら
教えて下さい。


　なんかもう、PIC2 ローダを作る気力が無くなってきた。

　次やるなら、BMP か GIF だなぁ。折角「Graphic File Format Handbook」も
あることだし。買ってからほとんど積ん読状態だったので、有効活用しなきゃ。
…と書いて１ヶ月。まだ積ん読のまま。


				〒500 岐阜市宇佐南１-２-５
							各務 裕之 （ＡＰｉ）

	東京	Natsume-Net				NAT26323
	東京	MARIO-NET				API
	岐阜	あしながねっと				API
	大阪	Illusion City				API
	愛知	PrincessPrincess-NET			API
	石川	ネットフレンティ金沢			NWC03867

	E-mail	:     kakami@toriwaki.nuie.nagoya-u.ac.jp
	URL	: http://www.toriwaki.nuie.nagoya-u.ac.jp/~kakami/


[eof]
