               ТЕКСТОВЫЙ МНОГООКОННЫЙ РЕДАКТОР
                       (10-БУФЕРНЫЙ)

                          NTOR

                        Версия 0.1

                           MSX2

                 Руководство пользователя


                       Леонид БАРАЗ


                      В тексте данного документа применяются
                      следующие  обозначения:  в   уголковые
                      скобки < и > берутся  названия  специ-
                      альных  клавиш;  пробелом  разделяются
                      клавиши, которые нужно нажимать после-
                      довательно, а плюсом - одновременно.


     Программа NTOR представляет  собой  экранный  текстовый
редактор. Этот редактор может использоваться на ПЭВМ MSX2 (в
т.ч.   "YAMAHA"   YIS805,   YIS503III),   под    управлением
операционной системы MSX-DOS. В программе использованы паке-
ты окон и меню, разработанные Е.В.Налимовым.

     Команда вызова редактора:
      A> NTor [файлы ...]

     Редактор предоставляет пользователю  разнообразные воз-
можности редактирования:
   - набирать, запоминать и корректировать тексты, состоящие
из строк произвольной длины  и  содержащие любые символы,  в
том числе  графические и управляющие;
   - редактировать одновременно  от 1 до 10 текстов  (каждый
текст  загружается  в отдельный текстовый буфер);  суммарный
размер текстов  ограничен  количеством доступной оперативной
памяти (около 22 500 символов);
   - использовать  при корректировке  разнообразные средства
редактирования: перемещение на символ/слово/строку/страницу,
удаление символа/слова/строки, запоминание строки символов и
включение  ее  в любом месте,  рассечение и склейка строк  и
другие;
   - выполнять простейшее форматирование текста  (оформление
абзацев с выравниванием правого края, центрирование заголов-
ков) как при вводе, так и по готовому тексту;
   - выполнять  поиск  по символьному образцу,  а также кон-
текстную замену с подтверждением и без;
   - располагать на экране  от  1  до  10  окон,  каждое  из
которых  связано  со  своей   частью   одного   или   разных
редактируемых текстов; размер и  положение  окон  на  экране
можно изменять в широких пределах;
   - фиксировать фрагмент  корректируемого  текста  и  затем
удалять, копировать или пересылать его на новое  место  того
же или другого буфера;
   - считывать в текстовые буфера любые файлы  (целиком  или
частично);
   - записывать содержимое каждого текстового буфера на диск
целиком или частично, как во вновь создаваемый файл, так и в
виде дополнения к существующему;
   - не выходя из редактора,  просматривать на экране  фраг-
менты любых файлов,  а также распечатывать их или содержимое
текстовых буферов;
   - устанавливать,  выполнять и корректировать макрокоманды
редактирования;
   - устанавливать текущую дату и текущее время;
   - менять цвета текста и фона;
   - в любой момент получать на экране краткую информацию  о
текущем состоянии редактора  и  имеющихся  в  данный  момент
средствах (по нажатию <ctrl>+?).


        1. Меню

     Основные операции при работе с  редактором  осуществля-
ются посредством обращения  к  меню  (исключение  составляют
только те операции редактирования, которые не требуют  отве-
тов на запросы, подтверждений и т.п.).

     Вход в меню происходит при  нажатии  клавиши  <select>.
При этом активизируется главное меню, находящееся в  верхней
строке  экрана.  Каждой   его   альтернативе   соответствует
уточняющее подменю, которое появляется на  экране  автомати-
чески. Активное в данный момент меню  выделяется  на  экране
двойной рамкой, а текущая позиция в нем - цветом (инверсом),
который играет роль курсора меню.

     Перемещение по меню выполняется с  помощью  стрелок,  а
выбор конкретной альтернативы - нажатием пробела или  клавиш
<ret> ("возврат каретки") или  <select}.  Клавиши  <stop>  и
<ctrl>+<stop> означают отказ  от  текущего  меню  (выход  из
него).

     Во всех меню, кроме меню оглавления диска, имеется воз-
можность быстро выбрать нужную альтернативу, нажав клавишу с
одним из символов в нужной строке меню. Этот символ  -  либо
прописная буква ("Replace" - R), либо цифра ("4 macro:" - 4)
из текста соответствующей альтернативы.  При  нажатии  такой
клавиши  курсор  меню  сразу  устанавливается  на  требуемую
альтернативу, после чего она исполняется (имитируется  нажа-
тие пробела).

     В меню оглавления диска  нажатие  клавиши  с  некоторой
буквой вызывает только установку курсора на ближайший  файл,
имя которого начинается с этой буквы. Выбор этого файла про-
исходит при нажатии клавиш пробел, <ret> или <select>.


        2. Редактирование текста

     Текст может редактироваться в режиме вставки и в режиме
замены. Режим вставки устанавливается автоматически при вхо-
де в редактор.  Смена режима происходит  при нажатии клавиши
<ins>.

     Курсор в режиме замены  представляет собой высокий пря-
моугольник,  а в режиме вставки - низкий.  При  этом  внутри
физической строки текста  прямоугольник сплошной,  а при вы-
ходе за ее пределы - незаполненный.  Следует обратить внима-
ние,  что при вводе  новых символов  за пределами физической
строки текста перед новым символом автоматически вставляются
недостающие пробелы.

     Для редактирования текста используются специальные кла-
виши (стрелки, перевод строки и т.д.) и управляющие комбина-
ции клавиш  (с нажатой клавишей  <ctrl>).  При этом  обычное
отождествление клавиш не используется:  например, комбинации
<ret>,  <ctrl>+<ret>,  <ctrl>+M  и  <shift>+<ctrl>+M  -  это
четыре разных указания редактору.


        2.1. Перемещение по тексту

<left>,
<right>          - передвижение курсора на один символ.
<ctrl>+<left>,
<ctrl>+<right>   - передвижение курсора на одно слово.
<shift>+<ctrl>+<left>,
<shift>+<ctrl>+<right>
                 - подвижка влево/вправо соответственно; кур-
                   сор сдвигается на один символ  в указанном
                   направлении, а окно  -  на  столько  же  в
                   обратном (таким образом, курсор на  экране
                   остается на месте).

<up>,
<down>           - передвижение курсора на одну строку.
<ctrl>+<up>,
<ctrl>+<down>    - передвижение  курсора   на  одну  страницу
                   (размер  страницы   определяется  размером
                   текущего окна).
<shift>+<ctrl>+<up>,
<shift>+<ctrl>+<down>
                 - подвижка вверх/вниз соответственно; курсор
                   сдвигается на одну строку  в указанном на-
                   правлении, а окно - на столько же в обрат-
                   ном (таким образом, курсор на экране оста-
                   ется на месте).

<ret>            - перевод  строки   (независимо   от  режима
                   вставки/замены).

<ctrl>+<tab>     - установка курсора  на ближайшую справа ко-
                   лонку табуляции  (в тексте никаких измене-
                   ний не происходит).
<shift>+<ctrl>+<tab>
                 - установка курсора  на ближайшую слева  ко-
                   лонку табуляции  (в тексте никаких измене-
                   ний не происходит).

<ctrl>+M         - подвод к строке  с данным номером  (номер
                   запрашивается в меню Edit-Line).
<shift>+<ctrl>+M - подвод к первой строке группы копирования
                   (установленной по <ctrl>+B).
<ctrl>+V         - подвод к первой строке текста.
<shift>+<ctrl>+V - подвод к последней строке текста.

<ctrl>+F         - установка  курсора  на  физический  конец
                   строки.
<shift>+<ctrl>+F - установка курсора на начало строки.


        2.2. Экранное редактирование

<ret>            - перевод  строки   (независимо   от  режима
                   вставки/замены).
<ctrl>+<ret>     - рассечение и перевод строки  (также  неза-
                   висимо от режима вставки/замены).

<ins>            - смена  режима вставки/замены  на  противо-
                   положный.
<ctrl>+<blank>   - вставка пробела  (при этом курсор остается
                   на прежнем месте).

<tab>            - запись  символа табуляции  (шаг  табуляции
                   пользователь  может  установить  с помощью
                   комбинации   клавиш   <ctrl>+|  или   меню
                   Set-tabStep).
<stop>           - после этой клавиши  следующий  управляющий
                   символ  записывается,   а  не  исполняется
                   (например,<stop> <ret> или <stop> <ctrl>+M
                   вызовут запись управляющего символа  с ко-
                   дом 0D).
<ctrl>+=         - запись символа по числовому коду  (код за-
                   прашивается в меню Edit-Code).

<ctrl>+[         - преобразование заглавных букв в строчные.
<shift>+<ctrl>+[ - преобразование строчных букв в заглавные.
<ctrl>+]         - преобразование русских букв в латинские.
<shift>+<ctrl>+] - преобразование латинских букв в русские.

<del>            - удаление символа, на котором стоит курсор.
<ctrl>+<del>     - удаление слова, начиная с позиции курсора.
<bs>             - удаление символа влево от позиции курсора.
<ctrl>+<bs>      - удаление слова влево от позиции курсора.

<ctrl>+E         - стирание всех символов  вправо от курсора
                   до конца строки.
<shift>+<ctrl>+E - стирание всех символов  влево  от курсора
                   до начала строки.

<ctrl>+<ins>     - вставка пустой строки перед текущей.
<ctrl>+K         - удаление текущей строки.
<ctrl>+N         - рассечение строки.
<ctrl>+J         - склейка строк.

<ctrl>+Y         - запоминание  символов  строки,  начиная  с
                   позиции курсора (запрос появляется в  меню
                   Edit-Yank; в ответ на него можно с помощью
                   стрелок и клавиш редактирования установить
                   запоминаемый текст и нажать клавишу <ret>;
                   если нажать эту клавишу сразу, запоминают-
                   ся все символы до конца строки).
<ctrl>+P         - вставка символов, запомненных по <ctrl>+Y.
                   (меню Edit-Paste).

<ctrl>+Z         - центрирование основного окна (курсор оста-
                   ется  в прежней  позиции  текста,  а  окно
                   устанавливается так,  чтобы курсор оказал-
                   ся как можно ближе к центру окна).

<home>           - подвод курсора к первой строке окна.
<cls> (т.е.<ctrl>+<home>)
                 - подвод курсора к последней строке окна.

<ctrl>+C         - восстановление строки:  если  строка была
                   удалена,  она  снова вставляется в текст;
                   если в ней были сделаны изменения, строка
                   в прежнем (до изменений) виде  включается
                   в текст перед измененной строкой. Повтор-
                   ное нажатие <ctrl>+C  убирает  восстанов-
                   ленную строку. Для правильного восстанов-
                   ления  строка  не должна быть длиннее 511
                   символов.


        2.3. Форматирование текста (меню Edit-Format)

<ctrl>+L         - форматирование абзаца (в абзац включаются
                   текущая строка  независимо от величины ее
                   левого поля  и  все последующие строки, у
                   которых отступ слева другой).
<shift>+<ctrl>+L - форматирование группы строк  (в интервале
                   строк от <ctrl>+B до <shift>+<ctrl>+B вы-
                   деляются и форматируются абзацы).

<shift>+<ctrl>+Z - центрирование заголовка.

<ctrl>+I         - включение/выключение  режима автоматичес-
                   кого форматирования при вводе.  В 80-сим-
                   вольном режиме  включенный режим формати-
                   рования отмечается строкой разметки внизу
                   экрана.
<shift>+<ctrl>+I - установка параметров форматирования:  по-
                   зиций левого  и  правого края,  отступа в
                   начале абзаца.  Установка параметров  вы-
                   полняется  в 80-символьном режиме.  Теку-
                   щие значения  параметров  отображаются  в
                   строке разметки  внизу экрана.  Изменение
                   параметра, отмеченного курсором, осущест-
                   вляется  стрелками,  а переход  от одного
                   параметра к другому - <ctrl>+стрелками.
<ctrl>+<         - установка  левого края по текущей позиции
                   курсора.
<ctrl>+>         - установка правого края по текущей позиции
                   курсора.
<ctrl>+\         - установка абзацного  отступа  по  текущей
                   позиции курсора.

     При автоматическом форматировании вводимого текста:
- ввод символа  правее установленного правого края  вызывает
  перенос лишних символов на новую строку (рассечение выпол-
  няется по пробелу между словами, правый край автоматически
  выравнивается);
- перевод строки <ret> воспринимается как признак завершения
  текущего абзаца и начало нового;  текущая строка не вырав-
  нивается; курсор устанавливается в позицию отступа при на-
  чале абзаца в следующей строке.


        2.4. Поиск  (меню  Edit-Search)

<ctrl>+S         - поиск образца  вперед  по тексту  (образец
                   запрашивается в строке Target).
<ctrl>+T         - поиск образца  назад  по  тексту  (образец
                   запрашивается в строке Target).
<ctrl>+Q         - продолжение поиска в прежнем направлении.

<shift>+<ctrl>+S,
<shift>+<ctrl>+T,
<shift>+<ctrl>+Q - имеют  тот же  смысл,  но  образец  ищется
                   только в начале слов (каждое слово состоит
                   из "однородных" символов:  букв/цифр, гра-
                   фических, управляющих и т.п.).

     Меню Edit-Search предоставляет возможность задать  текст
образца, характер поиска (по текущему буферу  текста  или  по
всем  буферам),  направление  (вперед/назад)  и   режим   (по
символам/по  словам).  Процесс  поиска  инициируется   первой
строкой меню.

     Ввод образца заканчивается нажатием клавиши <ret>.

     В образце поиска можно указывать  признак  произвольного
символа  <ctrl>+_.  При  поиске  ему   может   сопоставляться
произвольный символ.

     В образце поиска можно указывать признак  новой  строки;
он задается клавишами <ctrl>+<ret>.

     В строку образца можно вставить символы, запомненные  по
<ctrl>+Y. Для этого нужно нажать <ctrl>+P.

     Если при  поиске  вперед  (назад)  происходит  выход  на
последнюю (первую) строку, на  экран  выдается  сообщение,  и
поиск продолжается с первой (последней) строки.

     Поиск можно прервать, нажав <ctrl>+<stop>.


        2.5. Контекстная замена (меню Edit-Replace)

<ctrl>+X         - контекстная замена (запрашивается образец,
                   заменяющая строка и режим: с подтверждени-
                   ем или без).

<shift>+<ctrl>+X - то же, но образец ищется только  в  начале
                   слов.


     Меню Edit-Replace предоставляет возможность задать текст
образца и строки замены, характер замены  (в  текущем  буфере
текста или во всех буферах), и режим (по символам/по словам).
Процесс  замены  инициируется  первой  строкой  меню.   Перед
началом  процесса  замены  появляется  запрос,  требуется  ли
подтверждение каждой замены или нет.

     Ввод образца поиска и строки замены  заканчивается нажа-
тием клавиши <ret>.

     В образце поиска  и  в  строке  замены  можно  указывать
признак произвольного символа <ctrl>+_. При поиске ему  может
сопоставляться произвольный символ, а при замене на его месте
остается символ  из  найденного  образца  (или  пробел,  если
заменяющая строка длиннее образца поиска).

     В строке образца и/или замены  можно  указывать  признак
новой строки; он задается клавишами <ctrl>+<ret>.

     В строку образца  или  замены  можно  вставить  символы,
запомненные по <ctrl>+Y. Для этого нужно нажать <ctrl>+P.

     Если при в процессе просмотра текста происходит выход на
последнюю строку, на экран  выдается  сообщение,  и  просмотр
продолжается с первой строки.

     Процесс замены можно прервать, нажав <ctrl>+<stop>.


        2.5. Группы строк (меню Edit-Group)

<ctrl>+B         - пометка текущей строки  как первой строки
                   группы копирования (строка mark Top).
<shift>+<ctrl>+B - пометка  текущей  строки   как  последней
                   строки  группы  копирования  (строка  mark
                   Bottom).
                   На  экране   строки   группы   копирования
                   выделяются цветом в первой позиции.

<shift>+<ctrl>+M - подвод к первой строке группы копирования,
                   установленной по <ctrl>+B  (строка  Locate
                   group).

<ctrl>+G         - копирование  группы  строк   (строка  Copy
                   group). Текущая  строка  может  входить  в
                   состав копируемой группы.

<ctrl>+H         - пересылка группы строк (строка Move group)
                   выполняется так же,  как  и  <ctrl>+G,  но
                   копируемая группа строк  на  старом  месте
                   уничтожается).

<shift>+<ctrl>+K - удаление группы строк (строка Delete group);
                   перед удалением запрашивается подтверждение).


        3. Текстовые буфера (меню Buffers)

     Каждый редактируемый текст  располагается  в одном из 10
текстовых буферов. Буфера нумеруются цифрами от 0 до 9.  Кла-
виши управления буферами приведены ниже.

<ctrl>+R         - переход к следующему буферу  (с номером на
                   1 больше).

<shift>+<ctrl>+R - переход к предыдущему буферу (с номером на
                   1 меньше).

<ctrl>+D         - вход в меню информации обо  всех  буферах;
                   для  каждого  буфера   указываются   номер
                   последней строки, ориентировочный размер в
                   байтах, признак модификации и имя файла.
                   Нажав после просмотра одну из клавиш  0-9,
                   можно перейти в соответствующий буфер.


        4. Использование окон (меню Window)

     На экране редактор позволяет расположить одновременно от
1 до 10 текстовых окон. Курсор выставляется только в одном из
текстовых окон; оно считается основным.

     В левом верхнем  углу  рамки  каждого  окна  указывается
номер буфера, с которым связано данное окно,  и  текущее  имя
файла.  В  правом  нижнем  углу  отображается  номер  текущей
строки, номер последней строки, номер текущей позиции и номер
начальной  строки  окна.  Для  основного  окна,   в   котором
находится курсор, указывается также код  текущего  символа  и
номера буфера, первой и последней строк  группы  копирования,
если она установлена.

     В правом верхнем углу  экрана  находится  информационное
окошко, которое содержит  текущую  дату  и  время.  Здесь  же
отображается размер остатка свободной памяти. 

     Управление окнами осуществляется посредством меню Window,
которое содержит режимы  перехода  из  окна  в  окно  (Jump),
перемещения  окон  (Move),  изменения  размера  окна  (Size),
установки   естественного   расположения   окон   (Allocate),
создания (New) и уничтожения окон (Delete), а также  возврата
к начальному состоянию (Reset), при котором на экране имеется
только одно большое окне. Вход в меню Window происходит  либо
через главное меню, либо при нажатии <ctrl>+W.

     В процессе редактирования текста некоторые действия  над
окнами  можно  выполнять  и  с  помощью  управляющих  клавиш:
<graph>+стрелки - перемещение окна, <graph>+<ctrl>+стрелки  -
изменение размеров, <graph>+<esc> - переход  в  другое  окно,
<graph>+<select> - естественное расположение окон (т.е.  рас-
положение всех окон вокруг текущего, без наложений).


        5. Настройка (меню Set)

     Вход в меню Set происходит либо через главное меню, либо
при нажатии <ctrl>+*. В строках меню располагаются поля уста-
новки даты, времени,  цветов,  шага  табуляции  (<ctrl>+|)  и
режима  отображения  управляющих  символов   (<ctrl>+<stop>).
Последняя строка меню задает вход в меню макрокоманд.


        6. Макрокоманды (меню Set-Macro)

     Последовательность нажатых клавиш  может быть  оформлена
в виде макрокоманды. Всего имеется  10  макрокоманд,  которые
обозначаются цифрами от 0 до 9.

     Чтобы  начать  формирование  макрокоманды   в   процессе
редактирования, надо нажать клавиши  <shift>+<ctrl>+цифра,  и
затем выполнить  все  действия,  включаемые  в  макрокоманду.
Количество действий (т.е. управляющих или обычных  клавиш)  в
макрокоманде не может быть больше  64.  Результат  выполнения
этих действий, как обычно, виден на экране.

     Формирование  макрокоманды  заканчивается  при   нажатии
<ctrl>+@.  С  помощью  <ctrl>+@  можно  также  войти  в  меню
макрокоманд Set-Macro.  Это  меню  позволяет  отредактировать
любые макрокоманды, а также считать их с диска  или  записать
на  диск.  Редактирование  осуществляется  аналогично   вводу
образца поиска. Для  записи  управляющих  клавиш  перед  ними
необходимо нажимать <stop>.

     Для вызова макрокоманды во  время  редактирования  нужно
нажать <ctrl>+цифра. При этом все записанные при формировании
действия выполняются так, как если  бы  в  этот  момент  были
нажаты соответствующие клавиши.


        7. Файлы (меню Disk)

     Вход в  меню  работы  с  диском  происходит  либо  через
главное меню, либо при нажатии <esc>. Меню содержит следующие
альтернативы:
   Просмотр  оглавления:  запрашивается  имя  (например,*.*),
после чего строится специальное меню  оглавления  диска.  Для
каждого файла указывается информация о  его  имени,  размере,
дате и  времени  создания.  Выбрав  файл,  можно  посредством
дополнительного меню выполнить просмотр,  переименование  или
удаление файла.
   Загрузка: запрашивается имя, после чего  файл  или  файлы,
соответствующие ему, загружаются в буфера редактора. Если имя
файла указано однозначно, файл загружается  в  текущий  буфер
(даже если там имеется информация); при этом можно  загрузить
фрагмент файла или целый файл. Если имя  файла  неоднозначно,
на экране появляется меню файлов, выбор  в  котором  делается
либо  пользователем,  либо  автоматически.  Файлы  при   этом
загружаются только в пустые  буфера  и  только  целиком.  При
загрузке текста в  пустой  буфер  имя  файла  запоминается  в
качестве текущего для этого буфера. Текущее имя в  дальнейшем
предлагается по умолчанию при записи текста из данного буфера
на диск.
   Запись: появляется меню буферов, в котором  можно  указать
для  записи  либо  конкретный  буфер,   либо   все   непустые
буфера(строка  All  buffers),  либо  все  измененные   буфера
(строка Modified buffers). Текст из отдельного  буфера  можно
записать полностью или частично, тексты  из  всех  буферов  -
только полностью.
   Дописывание  из  текущего  буфера  в  хвост  существующего
файла.
   Печать одного или  нескольких  файлов  (аналогично  режиму
загрузки).
   Печать одного или всех буферов (аналогично  режиму  записи
на диск).
   Смена имени файла у текущего буфера.
   Очистка одного или всех буферов  (при  этом  автоматически
запрашивается, нужно ли записать тексты  на  диск,  если  они
изменеы).
   Окончание работы редактора (при этом также  запрашивается,
нужно ли записать измененные тексты).

     Процесс загрузки или записи нескольких  файлов  на  диск
можно прервать нажатием клавиши <ctrl>+<stop>.

     При просмотре и распечатке файлов для прекращения выдачи
нужно нажать <ctrl>+<stop>, а для  временной  приостановки  -
любую другую клавишу (выдача возобновляется при нажатии любой
клавиши).

     Некоторые  удобные  последовательности команд  работы  с
файлами  закреплены  за  функциональными клавишами.  Значения
функциональных клавиш  выдаются  на экран  вместе  со списком
команд в составе подсказки по  данному  меню  (после  нажатия
клавиши <ctrl>+?).

