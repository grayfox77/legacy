-------------------------------------------------------------------------------

	フロッピー　ディスク　エミュレータ(ハードディスク対応版)取扱い説明書

								Ver.1.04
							by	TSUYOSHI

-------------------------------------------------------------------------------


1.はじめに

	このソフトは、フロッピーディスクの内容をまるごとハードディスクに転送
	し、実行させるものです。その為ディスクのアクセスが瞬時に行われる様に
	なり、今までディスクのスピードの遅さに泣いていたソフトが見違える程快適
	に使えます。

	また、次の様な特徴があります。

	・ディスケットのアクセスが無くなる為マスターディスクを痛めません。
	・最初の読み込み時にプロテクトチェックを行い再現している為、マスターデ
	　ィスクをそのまま使う事ができます。
	・ソフトの実行中に他のディスクの内容に入れ換える事ができます。
	・最大９枚組までのソフトを動作させる事ができます。
	・本体をリセットせずにエミュレータの実行を中断する事ができます。
	・２ドライブ対応のソフトを動作させる事ができます。


2.動作環境について

	このソフトは以下の環境でないと動作しません。

	・機種：ＭＳＸ　Ｔｕｒｂｏ−Ｒ専用です。
		ＦＳ−Ａ１ＳＴ／ＧＴ以外の機種では動作しません。

	・メモリー：本体に空きメモリーマッパーが６４ｋＢ必要です。
		内蔵マッパーのみを使用します。外部スロットにマッパーがあると
		一部のソフトについてうまく動作しない場合があります。

		更に空きマッパーが３２ｋＢ有れば、自動的にオーバーレイデータを
		起動時に読み込み、実行時にマッパーから転送するために動作が
		速くなります。

	・ディスクドライブ：フロッピーディスクドライブ及びハードディスクが
			必要です。
			７３６ｋＢ以上のＲＡＭディスクが有ればハードディスクの
			代わりに使用可能です。

	・ＯＳ：ＭＳＸ−ＤＯＳ２が必要です。ＭＳＸ−ＤＯＳ１では動作しません。


3.使用方法

	・まず、ハードディスクにエミュレータのデータを保管するディレクトリを
	　作成します。

	・以下の２つのファイルをエミュレータのデータを保管するディレクトリか、
	　パスの通ったディレクトリにコピーします。
	　２つのファイルは同一のディレクトリに置きます。

		HDDEMU.COM	実行ファイル本体
		HDDEMU.OVL	オーバーレイデータ(データの実行時に必要)

	・コピーが終わったら、HDDEMU.COMを実行します。
	実行すると以下のメニュー表示が出てコマンド待ちになるはずです。

-------------------------------------------------------------------------------
 フロッピーディスクエミュレータ(ハードディスク対応版) Ver.1.04
 Copyright (c) 1994,1995,1996,1997,1998 by Ｔｓｕｙｏｓｈｉ

 [Ｅ]xecute	:データの実行
 [Ｌ]oad	:ハードディスクへの転送
 [Ｃ]onfigration:各種設定
 [Ｑ]uit	:エミュレータの終了

 選択して下さい [E,L,C,Q]:
-------------------------------------------------------------------------------

	・基本コマンドは４つあります。

	[Ｅ]xcute	ハードディスク上のデータを読み込み、エミュレータを
			実行させます。
	[Ｌ]oad		フロッピーディスクの内容をハードディスクへ転送します。
	[Ｃ]onfigration	ドライブ数の設定、CPU の切換え等の設定を行います。
	[Ｑ]uit		エミュレータのメニューを終了し、ＤＯＳに戻ります。


	・[Ｅ]xecute

	E コマンドを選択すると、ファイルが存在すれば選択画面になります。

-------------------------------------------------------------------------------
 選択して下さい [E,L,C,Q]:Ｅxecute

 ファイルの一覧表示を行います。

 SHIKAKU   MAKER     KUBIKIRI  SNATCHER  TENGU     XNA       MOONGIRL  TOUSHIN

 ファイルをカーソルキーで選んでリターンキーを押して下さい。(中止=Q,ESC):
-------------------------------------------------------------------------------

	実行したいファイルをカーソルキーで選んでリターンを押せば自動的に読み出
	され、エミュレータが実行されます。
	もし、充分なメモリーマッパーが無かった場合は、エラーを表示してメニュー
	に戻ります。


	・[Ｌ]oad

	L コマンドを選択すると、ハードディスクへの転送コマンドの状態になり、
	ファイル名の入力待ちになります。

	実行ファイルがディレクトリにあれば、ファイルの一覧表示を行い、ファイル
	の入力待ちになります。

	読み込みたいディスクのファイルを入力します。もし、ありえないファイル名
	の場合は再び入力を促してきます。
	また、既に同一のファイル名が存在すれば、上書きするかを尋ねてきます。
	ハードディスクの空き容量が無い場合はエラーを出して終了します。
	読み込ませたくない場合はそのままリターンキーのみを押せばメニューに
	戻ります。

-------------------------------------------------------------------------------
 選択して下さい [E,L,C,Q]:Ｌoad

 残り容量 = 45 枚分空きがあります。

 ファイル名を入力して下さい :DRSTOP

 ハードディスクへの転送を行います。残り容量 = 45 枚分空きがあります。

 1 枚目のディスケットを読み込みます 用意はいいですか？ [Yes=Y,RET No=N,Q,ESC]:Y

 ディスケットをセットして何かキーを押して下さい。[中止=Q,RET]:

 現在の転送中のファイル:DRSTOP.EM0

 読み込み中... セクター 0000 - 0031
-------------------------------------------------------------------------------

	ディスケットをセットして何かキーを押せば、読み込みを行います。
	途中で読み込みエラーが起きれば、エラーセクターの内容を表示します。

-------------------------------------------------------------------------------
 読み込み中... セクター 1408 - 1439

 ハードディスクへの転送が終了しました。残り容量 = 44 枚分空きがあります。

 2 枚目のディスケットを読み込みます 用意はいいですか？ [Yes=Y,RET No=N,Q,ESC]:
-------------------------------------------------------------------------------

	読み込みを終了すれば、次のディスケットを読み込ませるかを聞いてきます。
	もし、空き容量が無ければ自動的に終了します。
	ディレクトリ上には、以下のファイルが作成されます。

	*.EMn [n = 0,1,2,3...]	転送されたディスケットの内容。
	*.HED			各種設定用のヘッダーファイル。


	・[Ｃ]onfigration

	C コマンドを選択すると、ファイルが存在すれば選択画面になります。

-------------------------------------------------------------------------------
 選択して下さい [E,L,C,Q]:Ｃonfigration

 ファイルの一覧表示を行います。

 SHIKAKU   MAKER     KUBIKIRI  SNATCHER  TENGU     XNA       MOONGIRL  TOUSHIN
 DRSTOP

 ファイルをカーソルキーで選んでリターンキーを押して下さい。(中止=Q,ESC):

 各種設定　　ファイル:DRSTOP.HED

 [Ｄ]rive	:ドライブ数の設定　　現在=1ドライブモード
 [Ｃ]pu		:ＣＰＵの設定　　　　現在=Z80 CPU モード
 [Ｋ]ey		:切換えキーの設定　　現在=実行/取消キー
 [Ｂ]reak	:強制終了の設定　　　現在=無し
 [Ｓ]tart	:起動ディスクの設定　現在=1枚目から起動する
 [Ｐ]rotect	:書込み禁止の設定　　現在=無し
 [Ｑ]uit	:設定モードを終了する

 選択して下さい [D,C,K,B,S,P,Q]:
-------------------------------------------------------------------------------

	ファイルを選択すれば、ヘッダーファイルが読み出され、各種設定の画面に
	なり、コマンド待ちになります。

	コマンドは７つあります。


	[Ｄ]rive	エミュレータ上でのドライブ数の設定です。
			主に、[CTRL]立ち上げするソフトの為に行います。
			通常は設定しません。

		選択すると以下の入力待ちになります。

		[１]	:１ドライブモード(CTRL立ち上げ)
		[２]	:２ドライブモード(そのまま立ち上げる)
		[Ｑ]	:設定しない。

			大抵のソフトは１ドライブモードで動作します。
			ごく一部のソフトでは２ドライブモードで無いと立ち上がり
			ませんので設定を変更します。
			また、２ドライブ対応のソフトを動作させる場合に設定を
			変更します。


	[Ｃ]pu		エミュレータを動作させる場合のＣＰＵのタイプを設定
			します。

		選択すると以下の入力待ちになります。

		[Ｚ]80	:Z-80 CPU
		[Ｒ]800	:R800 CPU
		[Ｑ]uit	:設定しない

			大抵のソフトはZ-80 CPUモードで問題無しに動作します。
			もし、R800 CPUモードで動作させたい場合は設定を変更
			します。


	[Ｋ]ey		エミュレータの実行の途中でディスクの内容を切り換える
			場合の切換えの検出のキーを設定します。

		選択すると以下の入力待ちになります。

		[Ｊ]ikkou:実行/取消キー
		[Ｓ]hift :シフトキー
		[Ｇ]raph :グラフキー
		[Ｑ]uit  :設定しない

			大抵の場合はそのままの設定で行けます。
			キャッシュディスク等のキー設定がエミュレータと重なって
			しまう場合などに設定を変更します。


	[Ｂ]reak	エミュレータの実行を中断し、メニュー画面に戻すかを
			設定します。

		選択すると以下の入力待ちになります。

		[１]   :[CTRL+GRAPH+DEL]強制終了を有効にする
		[２]   :強制終了しない
		[Ｑ]uit:設定しない

			エミュレータの実行を中断したい場合に設定します。
			設定した場合は、CTRL、GRAPH、DELの３つのキーを実行中に
			同時に押すと、エミュレータの動作が中断され、メニューに
			戻ります。 (一部のソフトでは戻らない物も有ります)

			※強制終了は一応メニューに戻ってはきますが、かなり危険
			　を伴います。乱用は避けた方が良いとは思います。


	[Ｓ]tart	エミュレータを実行する時の起動ディスクを設定します。
			通常は設定しません。
			このコマンドはディスケットが複数組のみ設定できます。

		選択すると以下の入力待ちになります。

		[1-n]  :起動ディスクの番号を設定する (n = 枚数)
		[Ｑ]uit:設定しない

			大抵の場合はそのままの設定で行けます。
			例えば、デモディスクとゲームディスクが異なる場合に起動
			ディスクを変更したい場合に設定します。

			※誤って起動ディスクの番号を変更した場合は立ち上げがで
			　きなくなる事がありますので、もし変更する際にはディス
			　ケットの内容を確認の上行って下さい。


	[Ｐ]rotect	ディスクへの書込み禁止を設定します。
			通常は設定しません。

		選択すると以下の入力待ちになります。

		[１]   :ディスクへの書き込みを禁止する
		[２]   :書き込みを禁止しない
		[Ｑ]uit:設定しない

			大抵の場合はそのままの設定で行けます。
			ディスクに書き込みを行いたくない場合に設定します。
			設定するとソフトから書き込みの要求が有った場合には
			エミュレータはディスクの書き込み動作を行わずに、
			そのまま書き込みエラーを返します。


	[Ｑ]uit		設定モードを終了します。


4.エミュレータの実行中にディスクの入れ替えを要求された場合

	このソフトは、９枚分のディスクの番号を数字キーの [1-9]に対応させて
	います。

	ディスクの内容を切り換えて実行したい場合は、メニューの[各種設定]での
	[切換えキー]で設定したキーを押しながら操作します。

	[CAPS]ランプが点滅しますので、ここで数字の [1-9]キーを押すと
	押されたキーに対応するディスクの番号が選択され、実行されます。
	もし、存在しないキーの場合は無視されます。
	また、[ESC] キーを押せば現在の設定のまま戻ります。

	[CTRL+GRAPH+DEL]強制終了が有効になっていた場合、[Q]キーを押せば
	エミュレータの動作が中断され、メニューに戻ります。
	エミュレータの実行中に中断できないソフトでディスクのアクセスを行う場合
	に強制終了させる事ができます。

	フロッピーディスクにダイレクトにアクセスしたい場合は、[0] キーを
	押します。後はフロッピーディスクに対してのアクセスに変わります

	２ドライブモードではＡドライブ用とＢドライブ用に個別に設定ができます。


5.起動時のオプション

	オプションの設定方法は以下の通りです。

		HDDEMU <ファイル名>

	ファイル名を設定すれば、自動的に設定したファイルが読み込まれ、
	エミュレータが実行されます。
	ファイル名にはドライブ/パス名を含む事ができます。

	[CTRL+GRAPH+DEL]強制終了にて中断した場合はメニューに戻らず終了します。
	ファイラーの拡張子自動実行に組み込む際に便利です。

	ドライブ/パス名のみを設定した場合は、現在のカレントディレクトリを
	設定したドライブ/ディレクトリに変更し、メニュー表示になります。

	また、保管データの格納先ディレクトリを環境変数 hddemu によって指定する
	事ができます。

		SET HDDEMU = <ディレクトリ名>

	環境変数が指定されなければ現在選択されているディレクトリになります。

	環境変数とオプションの設定が同時に有った場合はオプションの方が
	優先します。


6.具体的な使い方

	大抵のソフトは、システムディスクとデータディスク（またはユーザーディス
	ク）に分かれていますので、システムの方をハードディスクに、データの方を
	フロッピーからアクセスする様に切り替えると使いやすいと思います。

	ディスクが１枚のみで、なおかつデータをロード、セーブしたい場合は、した
	いところでフロッピーディスクのアクセスに切り換えてマスターに対して行え
	ば良いと思います。

	２ドライブ対応のソフトを動作させる場合は、設定を２ドライブモードにして
	ディスク２枚分のデータを読み込ませれば、そのまま順番にＡドライブ用の
	データとＢドライブ用のデータになります。

	ハードディスクの代わりにＲＡＭディスクを使用する事も可能です。
	この場合は、ＭＳＸ−ＤＯＳ２が立ち上がる環境なら動作しますので、
	起動用のフロッピーディスクを用意して、ＭＳＸ−ＤＯＳ２のシステムと
	このソフトを入れて、内蔵マッパーを６４ｋＢだけ残してＲＡＭディスクを
	作成して起動すればそのまま使えると思います。

	更に３２ｋＢ空きマッパーが確保できる場合はオーバーレイデータを起動時に
	読み込み、後はマッパーから転送する様になるため、エミュレータ実行時の
	起動用のディスクからのオーバーレイデータの読み込みは無くなります。

	また、拙作のＲＡＭディスク復活ユーティリティーを併用すれば、マッパーを
	残したままＲＡＭディスクを作成したり、ＭＳＸ本体をリセットしても
	ＲＡＭディスクの内容が消えない様になるので便利かもしれません。

		設定例:

			A>RRAMDISK 4064 /U96 /A
			A>HDDEMU H:

	ハードディスクやリムーバブルメディアからＲＡＭディスクに転送し、
	ＲＡＭディスク上で動作させれば、更に高速な動作が見込めます。


7.うまく動作しない場合

	・全く起動しない場合

	ソフトがエミュレータのシステムのプログラムを破壊してしまう場合が有りま
	す。残念ながらこの場合はエミュレータが立ち上げる事ができませんので諦め
	て下さい。

	ソフトがＭＳＸ−ＤＯＳ２上で動作する場合は立ち上げる事ができません。

	・途中で止まったり、リセットしてしまう場合

	ディスクのプロテクトが判別できないタイプの場合に起こる事が有ります。こ
	の場合はプロテクトを外したディスクで行うしか有りません。（現在は最終ト
	ラック以外のマルチセクタ−フォ−マットには対応していません。）

	ソフトが独自でメモリーマッパーを操作しているものは動作がおかしくなりま
	す。また途中でメモリーチェックを行い、メモリーの内容を破壊してしまった
	場合の時も起こります。残念ながら諦めるしか有りません。

	ソフトによっては、何らかの要因で本物のＦＤＣＲＯＭの方へアクセスして
	しまっていて、仮想ＦＤＣＲＯＭからＭＳＸ−ＤＯＳ２に制御が移った途端に
	暴走してしまう事が有ります。
	恐らくＦＤＣＲＯＭアクセスに関するハードウェアによるプロテクトが絡んで
	いるのでは無いかと思われます。詳しい原因は不明です。

	一部のソフトでは２ドライブモードで無いと動作しない場合があります。

	・動作はするが、動きがどこかおかしい時

	Ｒ８００モードに対応していないソフトなのにＲ８００にモード設定を行った
	場合に起こります。この場合はＺ−８０モードで実行します。
	（Ｒ８００モードでは大抵、ＦＭ音源がうまく鳴りません。）

	ソフトによっては、グラフィック画面の描画の終了のチェックをＶＤＰのステ
	ータスにて行わずに、ディスケットの読み込み時間を使って省略している場合
	があります。この場合は残念ながらエミュレータに不向きなソフトとして諦め
	るしかありません。

	ディスクのプロテクトが判別できないタイプの場合に起こる事が有ります。
	一部のソフトではプロテクトが再現できないために動作が変わってしまう場合
	が有ります。この場合はプロテクトを外したディスクで行うしか有りません。


8.その他注意事項

	このソフトは２ＤＤ９セクタ−フォ−マット専用です。それ以外のディスクで
	は動作しません。
	また、ブ−トセクタ−の中でワ−クエリアの確保を行っているソフトは必ず暴
	走しますので注意して下さい。（ＤＯＳ上で動作している為です。）

	このソフトは一般的にファイル型式になっているもの程速くなります。セクタ
	−を直に、なおかつデ−タの並びを最適化しているもの程、速さはあまり変わ
	らなくなります。

	このソフトは以下のアプリケ−ションで動作の確認を行いました。

	・動作したソフト

		ガルフォース創世の序曲		（ソニー）
		イース２			（日本ファルコム）
		首斬り館			（ＢＩＴ２）
		スナッチャ−			（コナミ）
		プリンセスメーカー		（マイクロキャビン）
		サーク　ガゼルの塔		（マイクロキャビン）
		めぞん一刻完結編		（マイクロキャビン）
		原宿アフターダーク		（工画堂スタジオ）
		アンジェラス			（エニックス）
		闘神都市			（アリスソフト）
		キサナ				（フェアリ−テ−ル）
		校内写生１〜３			（フェアリ−テ−ル）
		ＣＡＬ１、２			（バ−ディ−ソフト）
		麻雀刺客			（日本物産）

	・残念ながら動作しなかったソフト（システムが暴走します。）

		ＤＯＬＬ			（ハ−ト電子）
		らんま１／２飛龍伝説		（ボ−ステック）
		幻影都市			（マイクロキャビン）
		フレイ				（マイクロキャビン）
		サーク				（マイクロキャビン）
		サーク２			（マイクロキャビン）
		レナム				（ヘルツ）


9.制作の苦労話

	このソフトは、ＦＤＤエミュレータを何とかハードディスクで動作させる事が
	できたらと思ったのがきっかけでした。

	市販ソフトはまず、セクターの直接アクセスを行うため、そのままではまず
	動作しません。そのため、仮想ＦＤＣＲＯＭを用意しなければなりません。

	色々悩んだ結果、ターボＲの場合はハードウェアで仮想ＦＤＣＲＯＭを作成
	できるため、何とか動作させる事ができました。

	このソフトは、ＭＳＸ−ＤＯＳ２上でソフトウェアにてＭＳＸ−ＤＯＳ１の
	環境をエミュレートしているため、一部の動作に変な所が有ると思います。
	対応ソフトを増やしたい所ですが、私の能力ではここまでが限界となって
	しまいます。正直な所、安定な仮想ＭＳＸ−ＤＯＳ１環境を実現できる方法が
	有れば私も知りたいです。


10.変更履歴

	94.春から夏

		SCSIによる大容量の記憶媒体が登場し、何か良い利用方法が
		無いかと思い、ハードディスク版のエミュレータを作ってみようと
		考える。
		しかし、MSX-DOS2上では市販のソフトは走らない。
		どうしようか悩む。

	94.秋
		何とかターボＲ専用なら実現可能な方法をふと思いつく。
		FDD エミュレータのソースを参考にしてプログラムをぽつぽつ
		作り出す。

	94.10.30	Ver.?.??

		試作バージョン。
		とりあえず動作する物なので、バグ多数有り。
		ドキュメントも３０分で作成したのでとっても悲惨。

	95.1.2		Ver.1.00

		これではまずいので完成度を高める。
		操作をメニュー形式にした。
		一部動作しないソフトに対応した。
		まだバグがあるかも知れない。

	95.1.8		Ver.1.01

		画面の表示のバグを修正。
		ファイル入力のバグを修正。
		エミュレータの実行時に画面を初期化していなかったバグを修正。
		エミュレータの実行中でもメニューに戻れる様にした。
		ディスクの入れ替えの際の検出キーの設定を変更できる様にした。

	96.7.21		Ver.1.02

		ディスケットを複数枚読み込ませた場合、
		起動ディスクを変更できる様にした。
		フロッピーディスクの判別方法を変えた。
		環境変数に対応した。

	97.1.20		Ver.1.03

		一部のソフトでＭＳＸ１モードで動作すると画面の表示が
		おかしくなるバグを修正。
		エミュレータの強制終了時にＦＭ音源やＳＣＣ音源が初期化されずに
		鳴りっ放しになっていたバグを修正。
		リムーバブルメディアでディスケットが存在しなかった場合に
		強制的に終了してしまうバグを修正。

	98.2.8		Ver.1.04

		２ドライブモード時にＢドライブがフロッピーディスク固定だった
		のを止めて、Ａ、Ｂ両ドライブ共にエミュレータで動作できる様に
		した。
		リムーバブルメディアを考慮し、エラーチェックを強化した。
		また、リムーバブルメディアで起こり得るディスクエラーの情報を
		ソフトへそのまま返す様にした。
		ハードディスクへの転送の際にフロッピー側で強制イジェクト等で
		Not Ready エラーを返した場合は転送を中断する様にした。
		リムーバブルメディアで書込み禁止にした場合に書き込みエラーが
		有った際に、無条件にエミュレータの動作が終了してしまうため、
		エミュレータ側でドライブに書込み禁止を行う事ができる様にし、
		書き込みエラーをソフトへ返す様にした。
		低価格のメモリーマッパーカートリッジが登場し、大容量のＲＡＭ
		ディスクが使用できる様になったため、ＲＡＭディスク上で動作
		できる様にした。


11.使用・再配布・移植・改良について

	このソフトは著作権を放棄していない「フリーソフトウェア」です。以下の条
	件に従って、自由に使用していただいて結構です。

	・著作権表示を変更しない事。
	・この HDDEMU.DOC も同時に配布すること。
	・改変を加えたとき（移植・改良など）には、改変者の氏名（ペンネーム）・
	　連絡先などとともに、変更が加えられていることを明示すること。
	・このソフトを使用したことによって生じた損害は、全く保証しない。
	・作者はこのソフトに不備があっても、それを訂正する義務を負わない。


12.何か気が付いた時の場合

	このソフトについての質問、感想、要望、バグ等について何か有りましたら、
	以下のネットまでメール等にてお願いいたします。

			Ｉｌｌｕｓｉｏｎ　Ｃｉｔｙ		R800
			Ｄｏ−ＲＡＧＯＮ　ＮＥＴ　ＣＩＴＹ．	R800
			ＭＳＸ Ｎetworker's Ｐoint		R800
